(function(a){a.infinitedrag=function(c,d,e){return new b(c,d,e)};a.infinitedrag.VERSION=0.1;var b=function(e,l,y){var k=this;var g=a(e);var d=g.parent();g.css({position:"relative",cursor:"move"});var f=(l)?l:{};var q={class_name:"_tile",width:100,height:100,start_col:0,start_row:0,range_col:[-1000000,1000000],range_row:[-1000000,1000000],oncreate:function(m,A,n){m.text(A+","+n)}};for(var t in y){if(y[t]!==undefined){q[t]=y[t]}}if(f.axis=="x"){q.range_row=[q.start_row,q.start_row]}else{if(f.axis=="y"){q.range_col=[q.start_col,q.start_col]}}function r(B,A){if(B<q.range_col[0]||q.range_col[1]<B){return}else{if(A<q.range_row[0]||q.range_row[1]<A){return}}c[B][A]=true;var m=B*q.width;var D=A*q.height;var n=g.append("<div></div>");var C=n.children(":last");C.attr({"class":q.class_name,col:B,row:A}).css({position:"absolute",left:m,top:D,width:q.width,height:q.height});q.oncreate(C,B,A)}var h=function(){u=d.width(),z=d.height(),w=Math.ceil(u/q.width),v=Math.ceil(z/q.height);var j=q.width/2,A=q.height/2,n=d.offset(),i=u-q.width,m=z-q.height;var B=[(-q.range_col[1]*q.width)+n.left+i,(-q.range_row[1]*q.height)+n.top+m,(-q.range_col[0]*q.width)+n.left,(-q.range_row[0]*q.height)+n.top,];g.draggable("option","containment",B)};var x=function(){var C=g;var B=C.parent();var E={left:C.offset().left-B.offset().left,top:C.offset().top-B.offset().top};var D=Math.ceil(-E.left/q.width)-1,A=Math.ceil(-E.top/q.height)-1;for(var n=D;n<=D+w;n++){for(var m=A;m<=A+v;m++){if(c[n]===undefined){c[n]={}}else{if(c[n][m]===undefined){r(n,m)}}}}};k.draggable=function(){return g};k.disabled=function(i){if(i===undefined){return g}g.draggable("option","disabled",i);g.css({cursor:(i)?"default":"move"})};k.center=function(i,F){var D=q.width*i,B=q.height*F,C=q.width/2,n=q.height/2,j=(d.width()/2)+d.position().left,E=(d.height()/2)+d.position().top,m=g.offset();var A={left:-D-(C-j),top:-B-(n-E)};if(f.axis=="x"){A.top=m.top}else{if(f.axis=="y"){A.left=m.left}}g.offset(A);x()};var u=d.width(),z=d.height(),w=Math.ceil(u/q.width),v=Math.ceil(z/q.height);g.offset({left:d.offset().left-(q.start_col*q.width),top:d.offset().top-(q.start_row*q.height)});var c={};for(var t=q.start_col,p=q.start_col+w;t<p&&(q.range_col[0]<=t&&t<=q.range_col[1]);t++){c[t]={};for(var s=q.start_row,o=q.start_row+v;s<o&&(q.range_row[0]<=s&&s<=q.range_row[1]);s++){r(t,s)}}a(window).resize(function(){h()});f.drag=function(j,i){x()};g.draggable(f);h()}})(jQuery);